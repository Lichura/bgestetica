scheduler.attachEvent("onTimelineCreated",function(e){"tree"==e.render&&(e.y_unit_original=e.y_unit,e.y_unit=scheduler._getArrayToDisplay(e.y_unit_original),scheduler.form_blocks[e.name]={render:function(e){var r="<div class='dhx_section_timeline' style='overflow: hidden; height: "+e.height+"px'></div>";return r},set_value:function(e,r,l,d){var t=scheduler._getArrayForSelect(scheduler.matrix[d.type].y_unit_original,d.type);e.innerHTML="";var n=document.createElement("select");e.appendChild(n);for(var i=e.getElementsByTagName("select")[0],c=0;c<t.length;c++){var u=document.createElement("option");u.value=t[c].key,u.value==l[scheduler.matrix[d.type].y_property]&&(u.selected=!0),u.innerHTML=t[c].label,i.appendChild(u)}},get_value:function(e){return e.firstChild.value},focus:function(){}})}),scheduler.attachEvent("onBeforeViewRender",function(e,r,l){var d={};if("tree"==e){var t,n,i,c,u,s;r.children?(t=l.folder_dy||l.dy,l.folder_dy&&!l.section_autoheight&&(i="height:"+l.folder_dy+"px;"),n="dhx_row_folder",c="dhx_matrix_scell folder",u="<div class='dhx_scell_expand'>"+(r.open?"-":"+")+"</div>",s=l.folder_events_available?"dhx_data_table folder_events":"dhx_data_table folder"):(t=l.dy,n="dhx_row_item",c="dhx_matrix_scell item",u="",s="dhx_data_table"),td_content="<div class='dhx_scell_level"+r.level+"'>"+u+"<div class='dhx_scell_name'>"+(scheduler.templates[l.name+"_scale_label"](r.key,r.label,l)||r.label)+"</div></div>",d={height:t,style_height:i,tr_className:n,td_className:c,td_content:td_content,table_className:s}}return d});var section_id_before;scheduler.attachEvent("onBeforeEventChanged",function(e,r,l){if(scheduler._isRender("tree")){var d=scheduler.getSection(e.section_id);if("undefined"!=typeof d.children&&!scheduler.matrix[scheduler._mode].folder_events_available)return l||(e[scheduler.matrix[scheduler._mode].y_property]=section_id_before),!1}return!0}),scheduler.attachEvent("onBeforeDrag",function(e,r,l){var d=scheduler._locate_cell_timeline(l);if(d){var t=scheduler.matrix[scheduler._mode].y_unit[d.y].key;if("undefined"!=typeof scheduler.matrix[scheduler._mode].y_unit[d.y].children&&!scheduler.matrix[scheduler._mode].folder_events_available)return!1}return scheduler._isRender("tree")&&(ev=scheduler.getEvent(e),section_id_before=t||ev[scheduler.matrix[scheduler._mode].y_property]),!0}),scheduler._getArrayToDisplay=function(e){var r=[],l=function(e,d){for(var t=d||0,n=0;n<e.length;n++)e[n].level=t,"undefined"!=typeof e[n].children&&"undefined"==typeof e[n].key&&(e[n].key=scheduler.uid()),r.push(e[n]),e[n].open&&e[n].children&&l(e[n].children,t+1)};return l(e),r},scheduler._getArrayForSelect=function(e,r){var l=[],d=function(e){for(var t=0;t<e.length;t++)scheduler.matrix[r].folder_events_available?l.push(e[t]):"undefined"==typeof e[t].children&&l.push(e[t]),e[t].children&&d(e[t].children,r)};return d(e),l},scheduler._toggleFolderDisplay=function(e,r,l){var d,t=function(e,r,l,n){for(var i=0;i<r.length&&(r[i].key!=e&&!n||!r[i].children||(r[i].open="undefined"!=typeof l?l:!r[i].open,d=!0,n||!d));i++)r[i].children&&t(e,r[i].children,l,n)};t(e,scheduler.matrix[scheduler._mode].y_unit_original,r,l),scheduler.matrix[scheduler._mode].y_unit=scheduler._getArrayToDisplay(scheduler.matrix[scheduler._mode].y_unit_original),scheduler.callEvent("onOptionsLoad",[])},scheduler.attachEvent("onCellClick",function(e,r){scheduler._isRender("tree")&&(scheduler.matrix[scheduler._mode].folder_events_available||"undefined"!=typeof scheduler.matrix[scheduler._mode].y_unit[r].children&&scheduler._toggleFolderDisplay(scheduler.matrix[scheduler._mode].y_unit[r].key))}),scheduler.attachEvent("onYScaleClick",function(e,r){scheduler._isRender("tree")&&"undefined"!=typeof r.children&&scheduler._toggleFolderDisplay(r.key)}),scheduler.getSection=function(e){if(scheduler._isRender("tree")){var r,l=function(e,d){for(var t=0;t<d.length;t++)d[t].key==e&&(r=d[t]),d[t].children&&l(e,d[t].children)};return l(e,scheduler.matrix[scheduler._mode].y_unit_original),r||null}},scheduler.deleteSection=function(e){if(scheduler._isRender("tree")){var r=!1,l=function(e,d){for(var t=0;t<d.length&&(d[t].key==e&&(d.splice(t,1),r=!0),!r);t++)d[t].children&&l(e,d[t].children)};return l(e,scheduler.matrix[scheduler._mode].y_unit_original),scheduler.matrix[scheduler._mode].y_unit=scheduler._getArrayToDisplay(scheduler.matrix[scheduler._mode].y_unit_original),scheduler.callEvent("onOptionsLoad",[]),r}},scheduler.addSection=function(e,r){if(scheduler._isRender("tree")){var l=!1,d=function(e,t,n){if(r)for(var i=0;i<n.length&&(n[i].key==t&&"undefined"!=typeof n[i].children&&(n[i].children.push(e),l=!0),!l);i++)n[i].children&&d(e,t,n[i].children);else n.push(e),l=!0};return d(e,r,scheduler.matrix[scheduler._mode].y_unit_original),scheduler.matrix[scheduler._mode].y_unit=scheduler._getArrayToDisplay(scheduler.matrix[scheduler._mode].y_unit_original),scheduler.callEvent("onOptionsLoad",[]),l}},scheduler.openAllSections=function(){scheduler._isRender("tree")&&scheduler._toggleFolderDisplay(1,!0,!0)},scheduler.closeAllSections=function(){scheduler._isRender("tree")&&scheduler._toggleFolderDisplay(1,!1,!0)},scheduler.openSection=function(e){scheduler._isRender("tree")&&scheduler._toggleFolderDisplay(e,!0)},scheduler.closeSection=function(e){scheduler._isRender("tree")&&scheduler._toggleFolderDisplay(e,!1)};