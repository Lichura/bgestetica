scheduler.attachEvent("onTemplatesReady",function(){function e(e,t,i,l){for(var o=t.getElementsByTagName(e),s=i.getElementsByTagName(e),n=s.length-1;n>=0;n--){var i=s[n];if(l){var r=document.createElement("SPAN");r.className="dhx_text_disabled",r.innerHTML=l(o[n]),i.parentNode.insertBefore(r,i),i.parentNode.removeChild(i)}else i.disabled=!0,t.checked&&(i.checked=!0)}}var t=scheduler.config.lightbox.sections.slice(),i=scheduler.config.buttons_left.slice(),l=scheduler.config.buttons_right.slice();scheduler.attachEvent("onBeforeLightbox",function(e){if(this.config.readonly_form||this.getEvent(e).readonly){this.config.readonly_active=!0;for(var o=0;o<this.config.lightbox.sections.length;o++)this.config.lightbox.sections[o].focus=!1}else this.config.readonly_active=!1,scheduler.config.lightbox.sections=t.slice(),scheduler.config.buttons_left=i.slice(),scheduler.config.buttons_right=l.slice();var s=this.config.lightbox.sections;if(this.config.readonly_active){for(var o=0;o<s.length;o++)if("recurring"==s[o].type){this.config.readonly_active&&s.splice(o,1);break}for(var n=["dhx_delete_btn","dhx_save_btn"],r=[scheduler.config.buttons_left,scheduler.config.buttons_right],o=0;o<n.length;o++)for(var c=n[o],h=0;h<r.length;h++){for(var d=r[h],a=-1,g=0;g<d.length;g++)if(d[g]==c){a=g;break}-1!=a&&d.splice(a,1)}}return this.resetLightbox(),!0});var o=scheduler._fill_lightbox;scheduler._fill_lightbox=function(){var t=this.getLightbox();this.config.readonly_active&&(t.style.visibility="hidden",t.style.display="block");var i=o.apply(this,arguments);if(this.config.readonly_active&&(t.style.visibility="",t.style.display="none"),this.config.readonly_active){var l=this.getLightbox(),n=this._lightbox_r=l.cloneNode(!0);n.id=scheduler.uid(),e("textarea",l,n,function(e){return e.value}),e("input",l,n,!1),e("select",l,n,function(e){return e.options.length?e.options[Math.max(e.selectedIndex||0,0)].text:""}),l.parentNode.insertBefore(n,l),s.call(this,n),scheduler._lightbox&&scheduler._lightbox.parentNode.removeChild(scheduler._lightbox),this._lightbox=n,scheduler.config.drag_lightbox&&(n.firstChild.onmousedown=scheduler._ready_to_dnd),this.setLightboxSize(),n.onclick=function(e){var t=e?e.target:event.srcElement;if(scheduler._getClassName(t)||(t=t.previousSibling),t&&t.className)switch(scheduler._getClassName(t)){case"dhx_cancel_btn":scheduler.callEvent("onEventCancel",[scheduler._lightbox_id]),scheduler._edit_stop_event(scheduler.getEvent(scheduler._lightbox_id),!1),scheduler.hide_lightbox()}},n.onkeydown=function(e){var t=e||window.event,i=e.target||e.srcElement,l=i.querySelector("[dhx_button]");switch(l||(l=i.parentNode.querySelector(".dhx_custom_button, .dhx_readonly")),(e||t).keyCode){case 32:if((e||t).shiftKey)return;l&&l.click&&l.click();break;case scheduler.keys.edit_cancel:scheduler.cancel_lightbox()}}}return i};var s=scheduler.showCover;scheduler.showCover=function(){this.config.readonly_active||s.apply(this,arguments)};var n=scheduler.hide_lightbox;scheduler.hide_lightbox=function(){return this._lightbox_r&&(this._lightbox_r.parentNode.removeChild(this._lightbox_r),this._lightbox_r=this._lightbox=null),n.apply(this,arguments)}});